<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Milaaje's Affordable Shop</title>
    <script src="https://js.paystack.co/v1/inline.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&family=Bebas+Neue&family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
        /* --- Color Variables (Matching your website's theme) --- */
        :root {
            --bg-darkest: #121212; /* Very dark background */
            --bg-card: #1a1a1a; /* Slightly lighter for cards */
            --text-light: #e0e0e0;
            --text-muted: #888888; /* Darker muted text for descriptions */
            --accent-dark-purple: #483D8B; /* Dark Slate Blue - main accent (from TrueMatch) */
            --accent-light-purple: #6A5ACD; /* Medium Slate Blue - hover/highlight (from TrueMatch) */
            --border-color: #333333;
            --error-color: #FF0000; /* Red for errors (if needed) */
            --live-red: #FF0000; /* For pulsing live indicator */
            /* Netflix-Inspired Colors (from your new shop content) */
            --netflix-red: #E50914;
            --netflix-dark: #141414;
            --netflix-darkest: #0d0d0d;
            --netflix-light-grey: #E5E5E5;
            --netflix-mid-grey: #444;

            /* NEW: Modernized Palette Adjustments */
            --primary-bg: #0C0C0C; /* Even darker, richer black */
            --secondary-bg: #1A1A1A; /* For cards and secondary elements */
            --accent-color: #7B68EE; /* Brighter, more vibrant slate blue for accent (IceConsort original) */
            --accent-hover: #9370DB; /* Lighter shade for hover (IceConsort original) */
            --text-primary: #F0F0F0;
            --text-secondary: #B0B0B0;
            --border-subtle: #2A2A2A;
            --gradient-start: rgba(123, 104, 238, 0.2);
            --gradient-end: rgba(123, 104, 238, 0.0);
        }

        /* --- Global Styles --- */
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--primary-bg); /* Use new primary bg */
            color: var(--text-primary); /* Use new primary text color */
            line-height: 1.6;
            overflow-x: hidden;
            scroll-behavior: smooth;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .container {
            max-width: 1200px; /* Increased max-width for bigger cards */
            margin: 0 auto;
            padding: 0 25px 80px; /* Adjusted padding, leaving space for fixed bottom nav */
            box-sizing: border-box;
        }

        /* --- Main Header (from TrueMatch) --- */
        #main-header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 100;
            background-color: rgba(0, 0, 0, 0.95); /* Adjusted from TrueMatch's 0.9 */
            box-shadow: 0 2px 8px rgba(0,0,0,0.5); /* Adjusted from TrueMatch's 10px */
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 5px 15px; /* Adjusted from TrueMatch's 10px 20px */
            box-sizing: border-box;
            backdrop-filter: blur(5px); /* Added from your original IceConsort header */
            -webkit-backdrop-filter: blur(5px); /* Added from your original IceConsort header */
            height: 45px; /* Adjusted to match your original IceConsort header height */
        }

        #site-title {
            font-family: 'Bebas Neue', sans-serif;
            color: var(--accent-color); /* Used IceConsort's accent-color */
            font-size: 1.5em; /* Adjusted to be between your original and TrueMatch's */
            letter-spacing: 1px;
            margin: 0;
            line-height: 1;
            flex-shrink: 0;
            text-shadow: 0 0 10px rgba(123, 104, 238, 0.3); /* Added from your original IceConsort header */
        }

        /* Dummy div to push content down, equal to initial header height */
        #header-spacer {
            height: 45px; /* Matching the main-header height */
        }

        /* --- Resources & Live Icons in Header (from TrueMatch, adapted) --- */
        .header-icons-group {
            display: flex;
            align-items: center;
            gap: 10px; /* Adjusted from TrueMatch's 15px */
            margin-left: auto;
        }

        .header-icon-link {
            display: flex;
            align-items: center;
            gap: 5px;
            color: var(--text-secondary); /* Used IceConsort's text-secondary */
            text-decoration: none;
            font-size: 0.8em; /* Adjusted from TrueMatch's 0.9em */
            font-weight: 500;
            cursor: pointer;
            transition: color 0.3s ease, transform 0.2s ease; /* Added transform from IceConsort */
        }

        .header-icon-link:hover {
            color: var(--text-primary); /* Used IceConsort's text-primary */
            transform: translateY(-1px); /* Added from IceConsort */
        }

        .header-icon-link .material-icons {
            font-size: 18px; /* Adjusted from TrueMatch's 24px */
            color: var(--accent-color); /* Used IceConsort's accent-color */
            transition: color 0.3s ease;
        }

        .header-icon-link:hover .material-icons {
            color: var(--accent-hover); /* Used IceConsort's accent-hover */
        }

        /* Live Indicator (from TrueMatch) */
        .live-indicator {
            width: 8px;
            height: 8px;
            background-color: var(--live-red);
            border-radius: 50%;
            display: inline-block;
            margin-left: 5px;
            position: relative;
            animation: pulse-red 1.5s infinite ease-out;
            box-shadow: 0 0 5px var(--live-red); /* Added from IceConsort */
        }

        @keyframes pulse-red {
            0% {
                transform: scale(0.8);
                opacity: 0.7;
            }
            50% {
                transform: scale(1.2);
                opacity: 1;
            }
            100% {
                transform: scale(0.8);
                opacity: 0.7;
            }
        }

        /* --- Fixed Bottom Navigation (from TrueMatch, adapted) --- */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: rgba(0, 0, 0, 0.95); /* Adjusted from TrueMatch's solid black */
            border-top: 1px solid var(--border-subtle); /* Added from your original IceConsort */
            display: flex;
            justify-content: space-around;
            padding: 12px 0; /* Adjusted from TrueMatch's 10px 0 */
            z-index: 100;
            box-shadow: 0 -4px 15px rgba(0,0,0,0.6); /* Added from your original IceConsort */
            backdrop-filter: blur(5px); /* Added from your original IceConsort */
            -webkit-backdrop-filter: blur(5px); /* Added from your original IceConsort */
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
            padding: 8px 0; /* Adjusted from TrueMatch's 5px 0 */
            color: var(--text-secondary); /* Used IceConsort's text-secondary */
            text-decoration: none;
            font-size: 0.85em; /* Adjusted from TrueMatch's 0.75em */
            transition: color 0.3s ease, transform 0.2s ease; /* Added transform from IceConsort */
            white-space: nowrap;
            text-shadow: 0 0 5px rgba(0,0,0,0.5); /* Added from IceConsort */
        }

        /* Home Nav Item - Default Purple (from TrueMatch, adapted) */
        /* Removed .home-nav-item class and applied active styles based on current page */

        /* Active state for bottom nav item - uses the accent color */
        body.page-home .bottom-nav .nav-item[href="index.html"],
        body.page-shop .bottom-nav .nav-item[href="shop.html"],
        body.page-legal .bottom-nav .nav-item[href="legal.html"],
        body.page-help .bottom-nav .nav-item[href="help.html"] {
            color: var(--accent-color); /* Used IceConsort's accent-color */
            font-weight: 600;
        }

        body.page-home .bottom-nav .nav-item[href="index.html"] .material-icons,
        body.page-shop .bottom-nav .nav-item[href="shop.html"] .material-icons,
        body.page-legal .bottom-nav .nav-item[href="legal.html"] .material-icons,
        body.page-help .bottom-nav .nav-item[href="help.html"] .material-icons {
            color: var(--accent-color); /* Used IceConsort's accent-color */
        }

        /* Hover state for bottom nav item */
        .nav-item:hover {
            color: var(--text-primary); /* Used IceConsort's text-primary */
            transform: translateY(-3px); /* Added from IceConsort */
        }

        /* Ensure icon color changes on hover too */
        .nav-item:hover .material-icons {
            color: var(--accent-color); /* Used IceConsort's accent-color */
        }

        /* Material Icons specific for bottom nav */
        .nav-item .material-icons {
            font-size: 30px; /* Adjusted from TrueMatch's 28px */
            margin-bottom: 6px; /* Adjusted from TrueMatch's 4px */
            color: var(--text-secondary); /* Used IceConsort's text-secondary */
            transition: color 0.3s ease;
        }

        /* Special styling for the plus icon (now 'Add') */
        .bottom-nav .nav-item.register-nav-item .material-icons {
            font-size: 38px; /* Adjusted from TrueMatch's 36px */
            color: var(--text-secondary); /* Used IceConsort's text-secondary */
        }
        /* No need for active/hover states specific to register-nav-item if handled by general .nav-item rules */


        /* --- Modals (Existing IceConsort styles, adjusted slightly for consistency) --- */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9); /* Darker overlay */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.4s ease, visibility 0.4s ease; /* Slower transition */
        }

        .modal-overlay.show-modal {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: linear-gradient(145deg, var(--secondary-bg), #0f0f0f); /* Subtle gradient */
            padding: 35px; /* Increased padding */
            border-radius: 12px; /* More rounded corners */
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.8); /* Stronger shadow */
            width: 90%;
            max-width: 550px; /* Slightly wider modal */
            position: relative;
            transform: translateY(30px) scale(0.95); /* Initial transform */
            opacity: 0;
            transition: transform 0.4s ease, opacity 0.4s ease;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid var(--border-subtle);
        }

        .modal-overlay.show-modal .modal-content {
            transform: translateY(0) scale(1);
            opacity: 1;
        }

        .modal-content h2 {
            font-family: 'Montserrat', sans-serif;
            color: var(--accent-color); /* Use new accent color */
            font-size: 2em; /* Larger title */
            margin-top: 0;
            margin-bottom: 30px; /* More space */
            text-align: center;
            text-shadow: 0 0 10px rgba(123, 104, 238, 0.4);
        }

        .modal-content .close-button {
            position: absolute;
            top: 18px; /* Adjusted position */
            right: 18px;
            color: var(--text-secondary);
            font-size: 32px; /* Larger close button */
            cursor: pointer;
            transition: color 0.3s ease, transform 0.2s ease;
            border-radius: 50%;
            padding: 5px;
        }

        .modal-content .close-button:hover {
            color: var(--text-primary);
            transform: rotate(90deg); /* Spin effect on hover */
            background-color: rgba(255,255,255,0.1);
        }

        /* --- Resources Menu Modal Specific Styles --- */
        #resourcesMenuModal h2 {
            color: var(--accent-color);
            text-shadow: 0 0 10px rgba(123, 104, 238, 0.4);
            margin-bottom: 25px;
        }

        .resources-menu-options {
            display: flex;
            flex-direction: column;
            gap: 15px; /* Increased gap */
        }

        .resources-menu-options a {
            display: flex;
            background-color: var(--primary-bg); /* Use primary bg */
            color: var(--text-primary);
            padding: 18px 25px; /* More padding */
            border-radius: 10px; /* More rounded */
            text-decoration: none;
            font-size: 1.15em; /* Slightly larger */
            font-weight: 500;
            transition: background-color 0.2s ease, color 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
            border: 1px solid var(--border-subtle);
            align-items: center;
            gap: 15px; /* Increased gap */
        }

        .resources-menu-options a:hover {
            background-color: var(--accent-color);
            color: white;
            transform: translateY(-5px) scale(1.02); /* More pronounced hover effect */
            box-shadow: 0 8px 20px rgba(0,0,0,0.6);
            border-color: var(--accent-hover);
        }

        .resources-menu-options a .material-icons {
            font-size: 28px; /* Larger icons */
            color: var(--accent-color);
            transition: color 0.2s ease;
        }

        .resources-menu-options a:hover .material-icons {
            color: white;
        }

        /* Add/Create Modal specific styles */
        #addCreateModal .add-create-options {
            display: flex;
            flex-direction: column;
            gap: 18px; /* Increased gap */
        }

        #addCreateModal .add-create-options button,
        #addCreateModal .add-create-options a button { /* Target buttons inside anchors too */
            background-color: var(--accent-color);
            color: white;
            padding: 18px 25px; /* More padding */
            border: none;
            border-radius: 8px; /* More rounded */
            font-size: 1.2em; /* Larger font */
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.2s ease;
            width: 100%;
            box-sizing: border-box;
            text-shadow: 0 1px 3px rgba(0,0,0,0.3);
            text-decoration: none; /* For the anchor */
            display: block; /* For the anchor */
        }

        #addCreateModal .add-create-options button:hover,
        #addCreateModal .add-create-options a button:hover {
            background-color: var(--accent-hover);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.4);
        }

        /* New Contact Form Modal Styles */
        #contactFormModal h2 {
            color: var(--accent-color);
            text-shadow: 0 0 10px rgba(123, 104, 238, 0.4);
            margin-bottom: 25px;
        }

        .contact-form label {
            display: block;
            margin-bottom: 10px; /* Increased margin */
            font-size: 1em; /* Slightly larger */
            color: var(--text-primary);
            font-weight: 500;
        }

        .contact-form input[type="text"],
        .contact-form input[type="email"],
        .contact-form textarea {
            width: calc(100% - 24px); /* Adjusted width for padding */
            padding: 12px; /* Increased padding */
            margin-bottom: 20px; /* More space */
            border: 1px solid var(--border-subtle);
            border-radius: 6px; /* More rounded */
            background-color: var(--primary-bg);
            color: var(--text-primary);
            font-family: 'Roboto', sans-serif;
            font-size: 1em;
            box-sizing: border-box;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }

        .contact-form input[type="text"]:focus,
        .contact-form input[type="email"]:focus,
        .contact-form textarea:focus {
            outline: none;
            border-color: var(--accent-hover);
            box-shadow: 0 0 0 4px rgba(123, 104, 238, 0.3); /* Accent glow on focus */
        }

        .contact-form textarea {
            resize: vertical;
            min-height: 140px; /* Taller textarea */
        }

        .contact-form input::placeholder,
        .contact-form textarea::placeholder {
            color: var(--text-muted);
            opacity: 0.8;
        }

        .contact-form button[type="submit"] {
            background-color: var(--accent-color);
            color: white;
            padding: 15px 30px; /* More padding */
            border: none;
            border-radius: 8px;
            font-size: 1.15em;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.2s ease;
            width: 100%;
            box-sizing: border-box;
            margin-top: 15px;
            text-shadow: 0 1px 3px rgba(0,0,0,0.3);
        }

        .contact-form button[type="submit"]:hover {
            background-color: var(--accent-hover);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.4);
        }

        .contact-form .mail-note {
            font-size: 0.88em;
            color: var(--text-secondary);
            text-align: center;
            margin-top: 20px;
        }

        /* --- Shop Specific Styles --- */
        #main-page-content {
            padding-top: 25px; /* Reset padding to remove header space */
            padding-bottom: 25px; /* Reset padding to remove bottom nav space */
        }

        header.shop-header {
            display: flex;
            align-items: center;
            padding: 25px 0; /* Increased padding */
            border-bottom: 1px solid var(--border-subtle);
            background-color: var(--primary-bg);
            position: sticky;
            top: 45px; /* Changed from 0px to account for new main-header */
            z-index: 99;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
            justify-content: flex-end;
            gap: 20px; /* Increased gap */
        }

        .search-bar-container {
            display: flex;
            align-items: center;
            position: relative;
            flex-grow: 1;
            max-width: 500px; /* Wider search bar */
        }

        #search-input {
            padding: 12px 45px 12px 20px; /* More padding, space for icon */
            border: 1px solid var(--border-subtle);
            border-radius: 8px; /* More rounded */
            width: 100%;
            font-size: 1.05rem; /* Slightly larger font */
            background-color: var(--secondary-bg);
            color: var(--text-primary);
            transition: all 0.3s ease;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.3);
        }

        #search-input:focus {
            outline: none;
            border-color: var(--accent-hover);
            box-shadow: 0 0 0 4px rgba(123, 104, 238, 0.3);
        }

        #search-button {
            display: none;
        }

        .cancel-search {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.4rem; /* Larger icon */
            cursor: pointer;
            display: none;
            transition: color 0.2s ease;
            padding: 5px;
        }

        .cancel-search:hover {
            color: var(--text-primary);
        }

        .cart-icon {
            position: relative;
            cursor: pointer;
            padding: 12px 20px; /* More padding */
            background-color: var(--accent-color);
            color: white;
            border-radius: 8px; /* More rounded */
            display: flex;
            align-items: center;
            gap: 10px; /* Increased gap */
            font-weight: bold;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.2s ease;
            white-space: nowrap;
            font-size: 1rem;
            text-shadow: 0 1px 3px rgba(0,0,0,0.3);
            border: 1px solid transparent;
        }

        .cart-icon:hover {
            background-color: var(--accent-hover);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
            border-color: var(--accent-hover);
        }

        #cart-count {
            background-color: var(--live-red);
            color: white;
            border-radius: 50%;
            padding: 4px 9px; /* Adjusted padding */
            font-size: 0.8rem;
            position: absolute;
            top: -10px; /* Adjusted position */
            right: -10px;
            min-width: 18px; /* Larger */
            text-align: center;
            border: 2px solid var(--primary-bg); /* Border to stand out */
            box-shadow: 0 0 5px rgba(0,0,0,0.5);
        }

        /* Hero Product Section - ENHANCED */
        .hero-section {
            background-color: var(--secondary-bg);
            margin-top: 40px; /* More space */
            margin-bottom: 60px; /* More space */
            padding: 0;
            border-radius: 12px; /* More rounded */
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.7); /* Stronger shadow */
            min-height: 550px; /* Taller hero section */
            position: relative;
            overflow: hidden;
            background-size: cover;
            background-position: center;
            text-align: center;
            transition: background-image 0.5s ease-in-out; /* Smooth image transition */
        }

        .hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to bottom, rgba(0,0,0,0.9) 0%, rgba(0,0,0,0.7) 50%, rgba(0,0,0,0.3) 100%); /* Stronger gradient */
            z-index: 1;
            transition: opacity 0.5s ease;
        }

        .hero-screen-content {
            z-index: 2;
            padding: 60px 30px; /* Increased padding */
            max-width: 800px; /* Wider content area */
            color: var(--text-primary);
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            transform: translateY(0);
            transition: transform 0.5s ease, opacity 0.5s ease;
        }

        .hero-product-image {
            display: none;
        }

        .hero-content .tag {
            background: linear-gradient(90deg, var(--accent-color), var(--accent-hover)); /* Gradient tag */
            color: white;
            padding: 10px 20px; /* More padding */
            border-radius: 5px;
            font-size: 1.1rem; /* Larger font */
            font-weight: bold;
            margin-bottom: 25px; /* More space */
            display: inline-block;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }

        .hero-content h2 {
            font-family: 'Bebas Neue', sans-serif; /* Use Bebas Neue for hero title */
            font-size: 4.5rem; /* Even larger font for hero title */
            margin: 25px 0;
            color: white; /* White for stronger contrast */
            text-shadow: 0 0 20px rgba(123, 104, 238, 0.7), 0 0 10px rgba(0,0,0,0.8); /* Stronger glow and shadow */
            line-height: 1.1;
            letter-spacing: 2px;
        }

        .hero-content p {
            font-size: 1.3rem; /* Larger description */
            line-height: 1.6;
            color: var(--text-secondary); /* Softer text color */
            margin-bottom: 35px; /* More space */
            max-width: 700px;
        }

        .hero-content .hero-price {
            font-size: 2.8rem; /* Larger price */
            font-weight: bold;
            color: var(--accent-hover); /* Brighter accent for price */
            margin-bottom: 35px;
            text-shadow: 0 0 15px rgba(123, 104, 238, 0.6);
        }

        .hero-buttons {
            display: flex;
            gap: 25px; /* Increased gap */
            margin-top: 20px;
        }

        .hero-content button {
            padding: 18px 40px; /* Larger buttons */
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.3rem; /* Larger font in buttons */
            font-weight: bold;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.2s ease;
            min-width: 220px; /* Consistent width */
            text-shadow: 0 1px 3px rgba(0,0,0,0.3);
            border: 1px solid transparent;
        }

        .hero-content button:hover {
            background-color: var(--accent-hover);
            transform: translateY(-5px) scale(1.02); /* More pronounced hover */
            box-shadow: 0 8px 20px rgba(0,0,0,0.6);
            border-color: var(--accent-hover);
        }

        /* Category Sliders (Netflix-style rows) */
        .category-section {
            margin-bottom: 50px; /* More space between sections */
        }

        .category-section h2 {
            color: var(--text-primary);
            font-family: 'Montserrat', sans-serif;
            font-size: 2.2rem; /* Larger category titles */
            margin-bottom: 25px; /* More space */
            padding-left: 15px;
            border-left: 5px solid var(--accent-color); /* Thicker accent border */
            padding-bottom: 8px;
            text-shadow: 0 0 10px rgba(0,0,0,0.5);
            letter-spacing: 0.5px;
        }

        .product-slider {
            display: flex;
            overflow-x: scroll;
            -webkit-overflow-scrolling: touch;
            padding: 15px; /* More padding around cards */
            gap: 20px; /* Increased gap between cards */
            scroll-snap-type: x mandatory;
            padding-bottom: 25px; /* Space for shadow */
        }

        .product-slider::-webkit-scrollbar {
            height: 10px; /* Make scrollbar visible */
        }

        .product-slider::-webkit-scrollbar-track {
            background: var(--primary-bg); /* Dark track */
            border-radius: 5px;
        }

        .product-slider::-webkit-scrollbar-thumb {
            background: var(--border-subtle); /* Muted thumb */
            border-radius: 5px;
            transition: background 0.3s ease;
        }

        .product-slider::-webkit-scrollbar-thumb:hover {
            background: var(--text-muted); /* Slightly lighter on hover */
        }

        .product-card {
            flex: 0 0 280px; /* Larger fixed width for cards */
            height: 400px; /* Taller cards */
            background: linear-gradient(145deg, var(--secondary-bg), #0f0f0f); /* Subtle gradient for cards */
            border-radius: 10px; /* More rounded */
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.6); /* Stronger shadow */
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            overflow: hidden;
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out, border-color 0.3s ease;
            cursor: pointer;
            scroll-snap-align: start;
            position: relative;
            border: 1px solid var(--border-subtle);
        }

        .product-card:hover {
            transform: scale(1.08); /* More pronounced scale on hover */
            z-index: 10;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.8);
            border-color: var(--accent-color); /* Accent border on hover */
        }

        .product-card img {
            width: 100%; /* Ensure image fills card width */
            height: 250px; /* Larger image area */
            object-fit: cover;
            border-radius: 10px 10px 0 0;
            transition: transform 0.3s ease;
        }

        .product-card:hover img {
            transform: scale(1.03); /* Subtle zoom on image within card */
        }

        .product-card .info {
            padding: 15px 20px 20px; /* More padding */
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            text-align: left; /* Align text left */
        }

        .product-card h3 {
            font-size: 1.25rem; /* Larger product title */
            margin-bottom: 8px;
            color: var(--text-primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-weight: 600;
        }

        .product-card p.category-text {
            font-size: 0.9rem; /* Slightly larger */
            color: var(--text-secondary);
            margin-bottom: 12px;
            font-style: italic;
        }

        .product-card .price {
            font-size: 1.2rem; /* Larger price */
            font-weight: bold;
            color: var(--accent-hover);
            margin-bottom: 15px;
            text-shadow: 0 0 8px rgba(123, 104, 238, 0.3);
        }

        .product-card button {
            padding: 12px 18px; /* More padding */
            border: none;
            border-radius: 6px; /* More rounded */
            cursor: pointer;
            font-size: 0.95rem; /* Slightly larger */
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.2s ease;
            font-weight: bold;
            flex-shrink: 0;
            text-shadow: 0 1px 2px rgba(0,0,0,0.3);
            border: 1px solid transparent; /* Subtle border */
        }

        .product-card .add-to-cart {
            background-color: var(--accent-color);
            color: white;
        }

        .product-card .add-to-cart:hover {
            background-color: var(--accent-hover);
            transform: translateY(-2px);
            box-shadow: 0 3px 10px rgba(0,0,0,0.3);
            border-color: var(--accent-hover);
        }

        .product-card .view-affiliate {
            background-color: var(--primary-bg); /* Darker background */
            color: var(--accent-color); /* Accent color for text */
            border: 1px solid var(--border-subtle);
        }

        .product-card .view-affiliate:hover {
            background-color: var(--border-color); /* Darker on hover */
            color: var(--text-primary); /* Lighter text on hover */
            transform: translateY(-2px);
            box-shadow: 0 3px 10px rgba(0,0,0,0.3);
        }

        /* Cart Popup Styles */
        .cart-popup {
            position: fixed;
            top: 25px; /* Adjusted to be at the top of the content */
            right: 25px; /* Adjusted position */
            width: 350px; /* Wider popup */
            background: linear-gradient(145deg, var(--secondary-bg), #0f0f0f);
            border: 1px solid var(--border-subtle);
            border-radius: 10px; /* More rounded */
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.7); /* Stronger shadow */
            padding: 20px; /* More padding */
            z-index: 1002;
            display: none;
            max-height: 80vh;
            overflow-y: auto;
        }

        .cart-popup h2 {
            margin-top: 0;
            font-size: 1.6rem;
            border-bottom: 1px solid var(--border-subtle);
            padding-bottom: 15px; /* More padding */
            margin-bottom: 15px;
            color: var(--text-primary);
            text-shadow: 0 0 8px rgba(0,0,0,0.4);
        }

        .cart-popup ul {
            list-style: none;
            padding: 0;
            margin-bottom: 15px;
        }

        .cart-popup li {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0; /* More padding */
            border-bottom: 1px dashed var(--border-subtle);
            font-size: 1rem; /* Slightly larger */
            color: var(--text-secondary);
        }

        .cart-popup li:last-child {
            border-bottom: none;
        }

        .cart-item-info {
            flex-grow: 1;
            margin-right: 15px;
        }

        .cart-item-info h4 {
            margin: 0 0 5px 0;
            color: var(--text-primary);
        }

        .cart-item-info span {
            font-size: 0.9em;
            color: var(--text-muted);
        }

        .cart-item-actions {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .cart-item-actions button {
            background-color: var(--accent-dark-purple);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 5px 8px;
            cursor: pointer;
            font-size: 0.9em;
            transition: background-color 0.2s ease;
        }

        .cart-item-actions button:hover {
            background-color: var(--accent-light-purple);
        }

        .cart-total {
            text-align: right;
            font-size: 1.4rem;
            font-weight: bold;
            color: var(--accent-hover);
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid var(--border-subtle);
            text-shadow: 0 0 8px rgba(123, 104, 238, 0.3);
        }

        .cart-checkout-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 25px;
        }

        .cart-checkout-form label {
            font-size: 0.95em;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .cart-checkout-form input,
        .cart-checkout-form select {
            width: calc(100% - 24px); /* Adjusted for padding */
            padding: 12px;
            border: 1px solid var(--border-subtle);
            border-radius: 6px;
            background-color: var(--primary-bg);
            color: var(--text-primary);
            font-size: 1em;
            box-sizing: border-box;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }

        .cart-checkout-form input:focus,
        .cart-checkout-form select:focus {
            outline: none;
            border-color: var(--accent-hover);
            box-shadow: 0 0 0 4px rgba(123, 104, 238, 0.3);
        }

        .cart-checkout-form button {
            background-color: var(--netflix-red);
            color: white;
            padding: 15px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1.15em;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.2s ease;
            margin-top: 20px;
            text-shadow: 0 1px 3px rgba(0,0,0,0.3);
        }

        .cart-checkout-form button:hover {
            background-color: #f00; /* Brighter red on hover */
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.4);
        }

        /* Product Detail Modal Styles */
        .product-detail-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1001;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.4s ease, visibility 0.4s ease;
        }

        .product-detail-modal-overlay.show-modal {
            opacity: 1;
            visibility: visible;
        }

        .product-detail-modal-content {
            background: linear-gradient(145deg, var(--secondary-bg), #0f0f0f);
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.8);
            width: 90%;
            max-width: 800px; /* Larger modal for details */
            position: relative;
            transform: translateY(30px) scale(0.95);
            opacity: 0;
            transition: transform 0.4s ease, opacity 0.4s ease;
            max-height: 90vh;
            overflow-y: auto;
            display: flex;
            gap: 30px;
            border: 1px solid var(--border-subtle);
        }

        .product-detail-modal-overlay.show-modal .product-detail-modal-content {
            transform: translateY(0) scale(1);
            opacity: 1;
        }

        .product-detail-image {
            flex: 1;
            min-width: 250px;
        }

        .product-detail-image img {
            width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        }

        .product-detail-info {
            flex: 2;
            display: flex;
            flex-direction: column;
            text-align: left;
        }

        .product-detail-info h2 {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 3em;
            color: var(--accent-color);
            margin-top: 0;
            margin-bottom: 15px;
            text-shadow: 0 0 10px rgba(123, 104, 238, 0.4);
        }

        .product-detail-info .category {
            font-size: 1.1em;
            color: var(--text-secondary);
            font-style: italic;
            margin-bottom: 10px;
        }

        .product-detail-info .price {
            font-size: 2em;
            font-weight: bold;
            color: var(--accent-hover);
            margin-bottom: 20px;
            text-shadow: 0 0 15px rgba(123, 104, 238, 0.6);
        }

        .product-detail-info .description {
            font-size: 1.1em;
            color: var(--text-primary);
            line-height: 1.7;
            margin-bottom: 30px;
        }

        .product-detail-info .actions {
            display: flex;
            gap: 20px;
            margin-top: auto; /* Push buttons to the bottom */
        }

        .product-detail-info button {
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.2s ease;
            text-shadow: 0 1px 3px rgba(0,0,0,0.3);
            flex-grow: 1;
        }

        .product-detail-info .add-to-cart-detail {
            background-color: var(--accent-color);
            color: white;
        }

        .product-detail-info .add-to-cart-detail:hover {
            background-color: var(--accent-hover);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.4);
        }

        .product-detail-info .view-affiliate-detail {
            background-color: var(--primary-bg);
            color: var(--accent-color);
            border: 1px solid var(--border-subtle);
        }

        .product-detail-info .view-affiliate-detail:hover {
            background-color: var(--border-color);
            color: var(--text-primary);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.4);
        }

        @media (max-width: 768px) {
            .product-detail-modal-content {
                flex-direction: column;
                max-width: 95%;
                gap: 20px;
            }
            .product-detail-info .actions {
                flex-direction: column;
            }
        }

        /* --- Responsive Adjustments (from TrueMatch, adapted) --- */
        @media (max-width: 992px) {
            #main-header {
                height: 45px; /* Keep consistent with desktop for now */
            }
            #header-spacer {
                height: 45px;
            }
            #site-title {
                font-size: 1.3em; /* Slightly smaller for tablets */
            }
            .header-icon-link {
                font-size: 0.75em;
            }
            .header-icon-link .material-icons {
                font-size: 16px;
            }
            header.shop-header {
                top: 45px; /* Adjust sticky header position */
            }
        }

        @media (max-width: 768px) {
            #main-header {
                padding: 5px 10px;
            }
            #site-title {
                font-size: 1.1em; /* Smaller for phones */
                letter-spacing: 0px;
            }
            .header-icon-link {
                font-size: 0.7em;
            }
            .header-icon-link .material-icons {
                font-size: 14px;
            }
            .live-indicator {
                width: 6px;
                height: 6px;
            }
            .bottom-nav .material-icons {
                font-size: 26px; /* Adjusted to be slightly smaller for phones */
            }
            .nav-item {
                font-size: 0.75em; /* Adjusted to be slightly larger for phones */
            }
            .bottom-nav .nav-item.register-nav-item .material-icons {
                font-size: 34px; /* Adjusted for consistency */
            }
        }

        @media (max-width: 480px) {
            #main-header {
                padding: 5px 8px;
            }
            #site-title {
                font-size: 1.0em;
            }
            .header-icon-link span {
                display:block; /* Hide text on small screens for header icons */
            }
            .header-icon-link .material-icons {
                font-size: 20px; /* Make icons larger when text is hidden */
            }
            .header-icons-group {
                gap: 5px;
            }
            .hero-content h2 {
                font-size: 3rem; /* Smaller hero title */
            }
            .hero-content p {
                font-size: 1.1rem; /* Smaller hero description */
            }
            .hero-content .hero-price {
                font-size: 2rem; /* Smaller hero price */
            }
            .hero-buttons {
                flex-direction: column; /* Stack buttons on small screens */
                gap: 15px;
            }
            .hero-content button {
                min-width: unset; /* Remove fixed width */
                width: 100%;
            }
        }
    </style>
</head>
<body class="page-shop">
    <header id="main-header">
        <h1 id="site-title">Mìlàájé</h1>
        <div class="header-icons-group">
            <a href="#" class="header-icon-link" id="openLiveLink">
                <span class="material-icons"></span>
              <span class="live-indicator"></span>
           <span>
                <span>Live</span>
           </span>
            </a>
            <a href="#" class="header-icon-link" id="openResourcesMenuModalLink">
                <span class="material-icons">menu_book</span>
                <span>Resources</span>
            </a>
        </div>
    </header>
    <div id="header-spacer"></div>

    <main id="main-page-content" class="container">
        <header class="shop-header">
            <div class="search-bar-container">
                <input type="text" id="search-input" placeholder="Search products...">
                <button id="search-button" style="display: none;">Search</button>
                <span class="material-icons cancel-search" id="cancel-search">close</span>
            </div>
            <div class="cart-icon" id="cart-icon">
                <span class="material-icons">shopping_cart</span>
                Cart
                <span id="cart-count">0</span>
            </div>
        </header>

        <section class="hero-section" id="hero-section">
            <div class="hero-screen-content" id="hero-content">
                <span class="tag" id="hero-tag">Over 50 people have read Hastings.</span>
                
        
                
            </div>
        </section>

        <div id="product-categories"></div>
    </main>

    <div class="bottom-nav">
        <a href="index.html" class="nav-item">
            <span class="material-icons">home</span>
            <span>Home</span>
        </a>
        <a href="shop.html" class="nav-item">
            <span class="material-icons">storefront</span>
            <span>Shop</span>
        </a>
        <a href="#" class="nav-item register-nav-item" id="openAddCreateModalLink">
            <span class="material-icons">add_circle</span>
            <span>Add</span>
        </a>
        <a href="legal.html" class="nav-item">
            <span class="material-icons">policy</span>
            <span>Legal</span>
        </a>
        <a href="help.html" class="nav-item">
            <span class="material-icons">help_outline</span>
            <span>Help</span>
        </a>
    </div>

    <div class="modal-overlay" id="cart-popup-modal">
        <div class="modal-content">
            <span class="material-icons close-button" id="close-cart-modal">close</span>
            <h2>Your Cart</h2>
            <ul id="cart-items-list">
                </ul>
            <div class="cart-total">
                Total: <span id="cart-total-amount">N0.00</span>
            </div>

            <form id="checkout-form" class="cart-checkout-form">
                <h3>Delivery Information</h3>
                <label for="checkout-name">Name:</label>
                <input type="text" id="checkout-name" name="name" required>

                <label for="checkout-email">Email:</label>
                <input type="email" id="checkout-email" name="email" required>

                <label for="checkout-country">Country:</label>
                <select id="checkout-country" name="country" required>
                    </select>

                <label for="checkout-address">Delivery Address:</label>
                <input type="text" id="checkout-address" name="address" required>

                <button type="submit" id="checkout-button">Proceed to Checkout</button>
            </form>
        </div>
    </div>

    <div class="product-detail-modal-overlay" id="product-detail-modal">
        <div class="product-detail-modal-content">
            <span class="material-icons close-button" id="close-product-detail-modal">close</span>
            <div class="product-detail-image">
                <img id="detail-image" src="" alt="Product Image">
            </div>
            <div class="product-detail-info">
                <h2 id="detail-name"></h2>
                <p class="category" id="detail-category"></p>
                <p class="price" id="detail-price"></p>
                <p class="description" id="detail-description"></p>
                <div class="actions">
                    <button id="detail-action-button"></button>
                </div>
            </div>
        </div>
    </div>

    <div id="resourcesMenuModal" class="modal-overlay">
        <div class="modal-content">
            <span class="close-button material-icons">close</span>
            <h2>Resources</h2>
            <div class="resources-menu-options">
                <a href="withdraw.html">
    <span class="material-icons">attach_money</span> Withdraw
</a>

                <a href="updates.html">
                    <span class="material-icons">article</span> Article, Blog, News
                </a>
                <a href="free.html">
                    <span class="material-icons">volunteer_activism</span> Coming Out Stories
                </a>
                <a href="skills.html">
                    <span class="material-icons">settings</span> Skill Learning 
                </a>
                          <a href="reviews.html">
                    <span class="material-icons">rate_review</span> Feedbacks & Ratings 
                </a>
                            </div>
        </div>
    </div>

    <div id="addCreateModal" class="modal-overlay">
        <div class="modal-content">
            <span class="close-button material-icons">close</span>
            <h2>Add or Create</h2>
            <div class="add-create-options">
                <a href="books.html"><button>Submit a Book</button></a>
               <a href="movies.html"><button>Submit a Movie</button></a>
                <a href="donate.html"><button id="donateButton"> Volunteer & Donate</button></a>
            </div>
        </div>
    </div>
<script src="productdata.js"></script>
<script>
        // Placeholder for user-provided keys/URLs
        const PAYSTACK_PUBLIC_KEY = 'pk_live_6b671064b6a716c1ceffe82bf20a28c317a69584'; // Replace with user's actual key
        const FORMSPREE_FORM_URL = 'https://formspree.io/f/xovdrlby'; // Replace with user's actual URL

        // Exchange rates (simplified for demonstration, not real-time)
        // Base currency is NGN (Naira).
        const EXCHANGE_RATES = {
            'NGN': 1,
            'USD': 0.00067, // Example rate, adjust as needed
            'GBP': 0.00053,
            'EUR': 0.00061,
            'INR': 0.056,
            // African countries (example rates, for demonstration)
            'ZAR': 0.012, // South African Rand
            'EGP': 0.032, // Egyptian Pound
            'KES': 0.087, // Kenyan Shilling
            'GHS': 0.0090, // Ghanaian Cedi
            'XOF': 0.40, // West African CFA franc
            'XAF': 0.40, // Central African CFA franc
            'DZD': 0.090, // Algerian Dinar
            'AOA': 0.56, // Angolan Kwanza
            'BWP': 0.0090, // Botswanan Pula
            'BIF': 2.0, // Burundian Franc
            'CVE': 0.065, // Cape Verdean Escudo
            'KMF': 3.0, // Comorian Franc
            'CDF': 1.8, // Congolese Franc
            'DJF': 0.12, // Djiboutian Franc
            'ERN': 0.010, // Eritrean Nakfa
            'ETB': 0.038, // Ethiopian Birr
            'GMD': 0.040, // Gambian Dalasi
            'GNF': 5.8, // Guinean Franc
            'LRD': 0.12, // Liberian Dollar
            'LYD': 0.0031, // Libyan Dinar
            'MGA': 3.0, // Malagasy Ariary
            'MWK': 1.1, // Malawian Kwacha
            'MRO': 0.02, // Mauritanian Ouguiya (old)
            'MUR': 0.030, // Mauritian Rupee
            'MAD': 0.0065, // Moroccan Dirham
            'MZN': 0.042, // Mozambican Metical
            'NAD': 0.012, // Namibian Dollar
            'RWF': 0.85, // Rwandan Franc
            'STN': 0.014, // Sao Tome and Principe Dobra
            'SLL': 20.0, // Sierra Leonean Leone
            'SOS': 0.38, // Somali Shilling
            'SSP': 0.12, // South Sudanese Pound
            'SDG': 0.60, // Sudanese Pound (old)
            'SZL': 0.012, // Swazi Lilangeni
            'TZS': 1.7, // Tanzanian Shilling
            'TND': 0.0021, // Tunisian Dinar
            'UGX': 2.5, // Ugandan Shilling
            'ZMW': 0.018, // Zambian Kwacha
            'ZWL': 1.0, // Zimbabwean Dollar (old)
            // Other major currencies for demonstration
            'CAD': 0.00091, // Canadian Dollar
            'AUD': 0.0010, // Australian Dollar
            'JPY': 0.10, // Japanese Yen
            'CNY': 0.0048 // Chinese Yuan
            // Add more African currencies as needed from a comprehensive list
        };

        const AFRICAN_COUNTRIES_CURRENCIES = {
            "Algeria": "DZD", "Angola": "AOA", "Benin": "XOF", "Botswana": "BWP", "Burkina Faso": "XOF",
            "Burundi": "BIF", "Cabo Verde": "CVE", "Cameroon": "XAF", "Central African Republic": "XAF",
            "Chad": "XAF", "Comoros": "KMF", "Congo (Brazzaville)": "XAF", "Congo (Kinshasa)": "CDF",
            "Cote d'Ivoire": "XOF", "Djibouti": "DJF", "Egypt": "EGP", "Equatorial Guinea": "XAF",
            "Eritrea": "ERN", "Eswatini": "SZL", "Ethiopia": "ETB", "Gabon": "XAF", "Gambia": "GMD",
            "Ghana": "GHS", "Guinea": "GNF", "Guinea-Bissau": "XOF", "Kenya": "KES", "Lesotho": "LSL",
            "Liberia": "LRD", "Libya": "LYD", "Madagascar": "MGA", "Malawi": "MWK", "Mali": "XOF",
            "Mauritania": "MRO", "Mauritius": "MUR", "Morocco": "MAD", "Mozambique": "MZN", "Namibia": "NAD",
            "Niger": "XOF", "Nigeria": "NGN", "Rwanda": "RWF", "Sao Tome and Principe": "STN",
            "Senegal": "XOF", "Seychelles": "SCR", "Sierra Leone": "SLL", "Somalia": "SOS",
            "South Africa": "ZAR", "South Sudan": "SSP", "Sudan": "SDG", "Swaziland": "SZL", "Tanzania": "TZS", "Togo": "XOF",
            "Tunisia": "TND", "Uganda": "UGX", "Zambia": "ZMW", "Zimbabwe": "ZWL"
        };

        const OTHER_COUNTRIES_CURRENCIES = {
            "United States": "USD", "United Kingdom": "GBP", "India": "INR",
            "Germany": "EUR", "France": "EUR", "Italy": "EUR", "Spain": "EUR", "Canada": "CAD", "Australia": "AUD",
            "Japan": "JPY", "China": "CNY"
            // Add more European countries if required, they typically use EUR
        };

        // Combine all countries for the select dropdown
        const ALL_COUNTRIES_AND_CURRENCIES = {
            ...AFRICAN_COUNTRIES_CURRENCIES,
            ...OTHER_COUNTRIES_CURRENCIES
        };


        // Product Data Array

        
        
        // Cart State
        let cart = JSON.parse(localStorage.getItem('iceconsortCart')) || [];

        // DOM Elements
        const cartIcon = document.getElementById('cart-icon');
        const cartCountSpan = document.getElementById('cart-count');
        const cartPopupModal = document.getElementById('cart-popup-modal');
        const closeCartModalButton = document.getElementById('close-cart-modal');
        const cartItemsList = document.getElementById('cart-items-list');
        const cartTotalAmount = document.getElementById('cart-total-amount');
        const searchInput = document.getElementById('search-input');
        const cancelSearchButton = document.getElementById('cancel-search');
        const productCategoriesContainer = document.getElementById('product-categories');
        const heroSection = document.getElementById('hero-section');
        const heroTitle = document.getElementById('hero-title');
        const heroDescription = document.getElementById('hero-description');
        const heroButton = document.getElementById('hero-button');
        const heroTag = document.getElementById('hero-tag');

        const productDetailModal = document.getElementById('product-detail-modal');
        const closeProductDetailModalButton = document.getElementById('close-product-detail-modal');
        const detailImage = document.getElementById('detail-image');
        const detailName = document.getElementById('detail-name');
        const detailCategory = document.getElementById('detail-category');
        const detailPrice = document.getElementById('detail-price');
        const detailDescription = document.getElementById('detail-description');
        const detailActionButton = document.getElementById('detail-action-button');

        const checkoutForm = document.getElementById('checkout-form');
        const checkoutNameInput = document.getElementById('checkout-name');
        const checkoutEmailInput = document.getElementById('checkout-email');
        const checkoutCountrySelect = document.getElementById('checkout-country');
        const checkoutAddressInput = document.getElementById('checkout-address');
        const checkoutButton = document.getElementById('checkout-button');

        // Define the desired order of categories
        const categoryOrder = [
            'BL Books',
            'Jeans',
            'Tshirt',
            'Boys Underwear',
            'Girls Jeans',
            'Hoodies',
            'GL Books',
            'Grooming',
            'Adult Boy Toys',
            'Adult Girl Toys',
        ];

        // Functions
        function updateCartDisplay() {
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            cartCountSpan.textContent = totalItems;
            cartCountSpan.style.display = totalItems > 0 ? 'flex' : 'none';
        }

        function saveCart() {
            localStorage.setItem('iceconsortCart', JSON.stringify(cart));
        }

        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            if (product && product.type === 'shoppable') {
                const existingItem = cart.find(item => item.id === productId);
                if (existingItem) {
                    existingItem.quantity++;
                } else {
                    cart.push({ ...product, quantity: 1 });
                }
                saveCart();
                updateCartDisplay();
                renderCartPopup();
                showModal(cartPopupModal);
            }
        }

        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            saveCart();
            updateCartDisplay();
            renderCartPopup();
            if (cart.length === 0) {
                hideModal(cartPopupModal);
            }
        }

        function calculateCartTotal(currencyCode = 'NGN') {
            let totalNaira = cart.reduce((sum, item) => sum + item.price * item.quantity, 0);
            const rate = EXCHANGE_RATES[currencyCode] || 1; // Default to 1 if currency not found (or NGN)
            return (totalNaira * rate).toFixed(2);
        }

        function formatCurrency(amount, currencyCode) {
            return new Intl.NumberFormat(undefined, {
                style: 'currency',
                currency: currencyCode,
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(amount);
        }

        function renderCartPopup(currencyCode = 'NGN') {
            cartItemsList.innerHTML = '';
            if (cart.length === 0) {
                cartItemsList.innerHTML = '<li style="justify-content: center; color: var(--text-muted);">Your cart is empty.</li>';
            } else {
                cart.forEach(item => {
                    const li = document.createElement('li');
                    li.innerHTML = `
                        <div class="cart-item-info">
                            <h4>${item.name}</h4>
                            <span>${formatCurrency(item.price, 'NGN')} x ${item.quantity}</span>
                        </div>
                        <div class="cart-item-actions">
                            <button onclick="removeFromCart('${item.id}')">Remove</button>
                        </div>
                    `;
                    cartItemsList.appendChild(li);
                });
            }
            cartTotalAmount.textContent = formatCurrency(calculateCartTotal(currencyCode), currencyCode);
        }

        function populateCountries() {
            for (const country in ALL_COUNTRIES_AND_CURRENCIES) {
                const option = document.createElement('option');
                option.value = country;
                option.textContent = country;
                checkoutCountrySelect.appendChild(option);
            }
        }

        function getCurrencyCodeForCountry(countryName) {
            return ALL_COUNTRIES_AND_CURRENCIES[countryName] || 'NGN'; // Default to NGN
        }

        // Modals
        function showModal(modalElement) {
            modalElement.classList.add('show-modal');
        }

        function hideModal(modalElement) {
            modalElement.classList.remove('show-modal');
        }

        // Render Product Cards
        function createProductCard(product) {
            const card = document.createElement('div');
            card.classList.add('product-card');
            card.dataset.productId = product.id; // Store product ID

            card.innerHTML = `
                <img src="${product.imageUrl}" alt="${product.name}">
                <div class="info">
                    <h3>${product.name}</h3>
                    <p class="category-text">${product.category.split('|')[0]}</p>
                    ${product.type === 'shoppable' ? `<p class="price">${formatCurrency(product.price, 'NGN')}</p>` : ''}
                    <button class="${product.type === 'shoppable' ? 'add-to-cart' : 'view-affiliate'}">
                        ${product.type === 'shoppable' ? 'Add to Cart' : 'View Product'}
                    </button>
                </div>
            `;

            const actionButton = card.querySelector('button');
            actionButton.addEventListener('click', (event) => {
                event.stopPropagation(); // Prevent card click event from firing
                if (product.type === 'shoppable') {
                    addToCart(product.id);
                } else {
                    window.open(product.affiliateLink, '_blank');
                }
            });

            card.addEventListener('click', () => showProductDetail(product.id));

            return card;
        }

        function renderCategorySliders(filteredProducts = products) {
            productCategoriesContainer.innerHTML = ''; // Clear previous categories

            const groupedProducts = {};
            filteredProducts.forEach(p => {
                const mainCategory = p.category.split('|')[0];
                if (!groupedProducts[mainCategory]) {
                    groupedProducts[mainCategory] = [];
                }
                groupedProducts[mainCategory].push(p);
            });

            // Render categories based on the defined order
            categoryOrder.forEach(categoryName => {
                if (groupedProducts[categoryName] && groupedProducts[categoryName].length > 0) {
                    const section = document.createElement('section');
                    section.classList.add('category-section');

                    const title = document.createElement('h2');
                    title.textContent = categoryName;
                    section.appendChild(title);

                    const slider = document.createElement('div');
                    slider.classList.add('product-slider');
                    groupedProducts[categoryName].forEach(product => {
                        slider.appendChild(createProductCard(product));
                    });
                    section.appendChild(slider);
                    productCategoriesContainer.appendChild(section);
                }
            });

            // Optional: Render any categories not explicitly listed in categoryOrder at the end
            for (const categoryName in groupedProducts) {
                if (!categoryOrder.includes(categoryName)) {
                    const section = document.createElement('section');
                    section.classList.add('category-section');

                    const title = document.createElement('h2');
                    title.textContent = categoryName;
                    section.appendChild(title);

                    const slider = document.createElement('div');
                    slider.classList.add('product-slider');
                    groupedProducts[categoryName].forEach(product => {
                        slider.appendChild(createProductCard(product));
                    });
                    section.appendChild(slider);
                    productCategoriesContainer.appendChild(section);
                }
            }
        }

        // Search Functionality
        searchInput.addEventListener('input', () => {
            const searchTerm = searchInput.value.toLowerCase().trim();
            if (searchTerm.length > 0) {
                cancelSearchButton.style.display = 'block';
            } else {
                cancelSearchButton.style.display = 'none';
            }

            const filteredProducts = products.filter(product =>
                product.name.toLowerCase().includes(searchTerm) ||
                product.description.toLowerCase().includes(searchTerm) ||
                product.category.toLowerCase().includes(searchTerm)
            );
            renderCategorySliders(filteredProducts);
        });

        cancelSearchButton.addEventListener('click', () => {
            searchInput.value = '';
            cancelSearchButton.style.display = 'none';
            renderCategorySliders(products); // Show all products again
        });

        // Product Detail Modal
        function showProductDetail(productId) {
            const product = products.find(p => p.id === productId);
            if (product) {
                detailImage.src = product.imageUrl;
                detailImage.alt = product.name;
                detailName.textContent = product.name;
                detailCategory.textContent = product.category.split('|')[0];
                detailDescription.textContent = product.description;

                if (product.type === 'shoppable') {
                    detailPrice.textContent = formatCurrency(product.price, 'NGN');
                    detailActionButton.textContent = 'Add to Cart';
                    detailActionButton.className = 'add-to-cart-detail';
                    detailActionButton.onclick = () => {
                        addToCart(product.id);
                        hideModal(productDetailModal);
                    };
                } else {
                    detailPrice.textContent = 'Price varies (AliExpress)';
                    detailActionButton.textContent = 'View Product on AliExpress';
                    detailActionButton.className = 'view-affiliate-detail';
                    detailActionButton.onclick = () => {
                        window.open(product.affiliateLink, '_blank');
                        hideModal(productDetailModal);
                    };
                }
                showModal(productDetailModal);
            }
        }

        // Hero Section Population
        function populateHeroProduct(product) {
            if (!product) {
                heroSection.style.display = 'none'; // Hide if no product available
                return;
            }
            heroSection.style.backgroundImage = `url('${product.imageUrl}')`;
            heroTitle.textContent = product.name;
            heroDescription.textContent = product.description;

            if (product.type === 'shoppable') {
                heroButton.textContent = `Add to Cart - ${formatCurrency(product.price, 'NGN')}`;
                heroButton.onclick = () => addToCart(product.id);
                heroButton.style.backgroundColor = 'var(--accent-color)';
            } else {
                heroButton.textContent = 'View Product on AliExpress';
                heroButton.onclick = () => window.open(product.affiliateLink, '_blank');
                heroButton.style.backgroundColor = 'var(--primary-bg)';
                heroButton.style.color = 'var(--accent-color)';
                heroButton.style.border = '1px solid var(--accent-color)';
            }
        }

        // Paystack & Formspree Integration
        function payWithPaystack() {
            const totalAmount = parseFloat(calculateCartTotal('NGN')) * 100; // Paystack requires amount in kobo/cents
            const customerEmail = checkoutEmailInput.value;
            const customerName = checkoutNameInput.value;
            const customerCountry = checkoutCountrySelect.value;
            const customerAddress = checkoutAddressInput.value;

            if (cart.length === 0) {
                alert("Your cart is empty. Please add items before checking out.");
                return;
            }
            if (!customerEmail || !customerName || !customerCountry || !customerAddress) {
                alert("Please fill in all delivery information fields.");
                return;
            }

            let handler = PaystackPop.setup({
                key: PAYSTACK_PUBLIC_KEY, // Replace with your public key
                email: customerEmail,
                amount: totalAmount,
                currency: 'NGN', // Always checkout in NGN on Paystack, conversion happens visually
                ref: '' + Math.floor((Math.random() * 1000000000) + 1), // generates a unique reference number
                metadata: {
                    custom_fields: [
                        { display_name: "Customer Name", variable_name: "customer_name", value: customerName },
                        { display_name: "Customer Country", variable_name: "customer_country", value: customerCountry },
                        { display_name: "Delivery Address", variable_name: "delivery_address", value: customerAddress },
                        { display_name: "Cart Items", variable_name: "cart_items", value: JSON.stringify(cart) },
                    ]
                },
                callback: function(response) {
                    // Payment successful
                    alert('Payment successful! Reference: ' + response.reference);
                    submitToFormspree(customerName, customerEmail, customerCountry, customerAddress, response.reference, totalAmount / 100);
                    cart = []; // Clear cart after successful payment
                    saveCart();
                    updateCartDisplay();
                    renderCartPopup();
                    hideModal(cartPopupModal);
                    // Redirect or show thank you message
                    alert("Thank you for your purchase! Your product will be delivered shortly.");
                },
                onClose: function() {
                    // Payment window closed
                    alert('Payment window closed.');
                }
            });
            handler.openIframe();
        }

        async function submitToFormspree(name, email, country, address, paystackRef, totalPaidNaira) {
            const cartDetails = cart.map(item => `${item.name} (${item.quantity})`).join(', ');

            try {
                const response = await fetch(FORMSPREE_FORM_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify({
                        name: name,
                        email: email,
                        country: country,
                        address: address,
                        cart_items: cartDetails,
                        total_paid_naira: totalPaidNaira,
                        paystack_reference: paystackRef,
                        timestamp: new Date().toISOString()
                    })
                });

                if (response.ok) {
                    console.log('Form data submitted to Formspree successfully!');
                    // No need to redirect again, already handled by Paystack callback
                } else {
                    console.error('Formspree submission failed:', response.statusText);
                    alert('There was an issue submitting your order details. Please contact support with your payment reference: ' + paystackRef);
                }
            } catch (error) {
                console.error('Error submitting to Formspree:', error);
                alert('An error occurred while submitting your order details. Please contact support with your payment reference: ' + paystackRef);
            }
        }


        // Event Listeners
        document.addEventListener('DOMContentLoaded', () => {
            updateCartDisplay();
            renderCategorySliders(products);
            populateCountries(); // Populate the country dropdown

            // Select a trending product for the hero section.
            // It looks for the first 'shoppable' product that also has a 'heroImageUrl'.
            // If none found, it falls back to the very first product in the 'products' array.
            const trendingProduct = products.find(p => p.type === 'shoppable' && p.heroImageUrl) || products[0];
            populateHeroProduct(trendingProduct); // Populate hero with trending or first product
        });

        cartIcon.addEventListener('click', () => {
            renderCartPopup(getCurrencyCodeForCountry(checkoutCountrySelect.value)); // Render cart with initial currency
            showModal(cartPopupModal);
        });
        closeCartModalButton.addEventListener('click', () => hideModal(cartPopupModal));
        cartPopupModal.addEventListener('click', (e) => {
            if (e.target === cartPopupModal) {
                hideModal(cartPopupModal);
            }
        });

        closeProductDetailModalButton.addEventListener('click', () => hideModal(productDetailModal));
        productDetailModal.addEventListener('click', (e) => {
            if (e.target === productDetailModal) {
                hideModal(productDetailModal);
            }
        });

        checkoutCountrySelect.addEventListener('change', () => {
            const selectedCountry = checkoutCountrySelect.value;
            const currencyCode = getCurrencyCodeForCountry(selectedCountry);
            renderCartPopup(currencyCode); // Re-render cart total with new currency
        });

        checkoutForm.addEventListener('submit', function(e) {
            e.preventDefault();
            payWithPaystack();
        });

        // Other main header links (placeholders for now)
        // document.getElementById('profile-link').addEventListener('click', (e) => { e.preventDefault(); alert('Profile feature not yet implemented.'); });
        // document.getElementById('contact-link').addEventListener('click', (e) => { e.preventDefault(); alert('Contact feature not yet implemented.'); });
        // document.getElementById('resources-link').addEventListener('click', (e) => { e.preventDefault(); alert('Resources feature not yet implemented.'); });
        // The add/create link's functionality is already implemented in the Legal TrueMatch file and will be available.
        document.getElementById('openAddCreateModalLink').addEventListener('click', (e) => { e.preventDefault();
            showModal(addCreateModal); // Assuming addCreateModal is now defined in this scope
        });

        // Modals from Legal TrueMatch
        const addCreateModal = document.getElementById('addCreateModal');
        const registrationModal = document.getElementById('registrationModal'); // Assuming this modal exists in your full HTML
        const resourcesMenuModal = document.getElementById('resourcesMenuModal');
        const contactFormModal = document.getElementById('contactFormModal'); // Assuming this modal exists

        // Get close buttons for all modals
        const addCreateModalCloseButton = addCreateModal ? addCreateModal.querySelector('.close-button') : null;
        const registrationModalCloseButton = registrationModal ? registrationModal.querySelector('.close-button') : null; // Assuming close button exists
        const resourcesMenuCloseButton = resourcesMenuModal ? resourcesMenuModal.querySelector('.close-button') : null;
        const contactFormModalCloseButton = contactFormModal ? contactFormModal.querySelector('.close-button') : null;

        // Add/Create Modal functionality (from Legal TrueMatch.txt)
        document.getElementById('openAddCreateModalLink').addEventListener('click', (e) => {
            e.preventDefault();
            showModal(addCreateModal);
        });

        // Resources Menu Modal functionality (from Legal TrueMatch.txt)
        document.getElementById('openResourcesMenuModalLink').addEventListener('click', (e) => {
            e.preventDefault();
            showModal(resourcesMenuModal);
        });

        // Add a listener for the "Live" link to match your provided header HTML
        document.getElementById('openLiveLink').addEventListener('click', (e) => {
            e.preventDefault();
            alert('Redirecting to Live Content! (This link is a placeholder)'); // Example: window.location.href = 'your-live-page.html';
        });

        // You might need to add a specific element for 'contact-link' in your HTML if you want to reuse that ID.
        // For now, I'm assuming it might be another way to open the contact form modal if it exists.
        // If your original HTML doesn't have an element with ID 'contact-link' or 'profile-link', these listeners won't attach.

        // Close Buttons for all modals (from Legal TrueMatch.txt)
        if (addCreateModalCloseButton) {
            addCreateModalCloseButton.addEventListener('click', () => {
                hideModal(addCreateModal);
            });
        }

        if (addCreateModal) {
            addCreateModal.addEventListener('click', (e) => {
                if (e.target === addCreateModal) {
                    hideModal(addCreateModal);
                }
            });
        }

        if (registrationModalCloseButton) {
            registrationModalCloseButton.addEventListener('click', () => {
                hideModal(registrationModal);
            });
        }

        if (registrationModal) {
            registrationModal.addEventListener('click', (e) => {
                if (e.target === registrationModal) {
                    hideModal(registrationModal);
                }
            });
        }

        if (resourcesMenuCloseButton) {
            resourcesMenuCloseButton.addEventListener('click', () => {
                hideModal(resourcesMenuModal);
            });
        }

        if (resourcesMenuModal) {
            resourcesMenuModal.addEventListener('click', (e) => {
                if (e.target === resourcesMenuModal) {
                    hideModal(resourcesMenuModal);
                }
            });
        }

        if (contactFormModalCloseButton) {
            contactFormModalCloseButton.addEventListener('click', () => {
                hideModal(contactFormModal);
            });
        }

        if (contactFormModal) {
            contactFormModal.addEventListener('click', (e) => {
                if (e.target === contactFormModal) {
                    hideModal(contactFormModal);
                }
            });
        }

        // Live Link functionality (from Legal TrueMatch.txt)
        // Corrected selector for the 'Live' link in the bottom nav based on your provided HTML
        const liveNavLink = document.querySelector('.bottom-nav .nav-item span:has(.live-indicator)');
        if (liveNavLink) {
            liveNavLink.addEventListener('click', (e) => {
                e.preventDefault();
                alert('Redirecting to Live Content! (This link is a placeholder)');
            });
        }

    </script>
</body>
</html>
